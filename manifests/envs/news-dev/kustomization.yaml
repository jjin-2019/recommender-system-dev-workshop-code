apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# namespace to deploy all resources to
namespace: rs-news-dev-ns

resources:
- config.yaml
- gateway.yaml
- ./efs/pv-claim.yaml
- ../../loader
- ../../filter
- ../../portrait
- ../../rank
- ../../recall
- ../../redis
- ../../event
- ../../retrieve
- ../../demo
- ui
- ../../personalize

# all with following *kustomization*
images:
- name: rs/demo
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/demo
  newTag: 524553472d9f6b0bfdb3f08d68f56bc1c17d1bf1
- name: rs/event
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/event
  newTag: 5d2609f82e3d2ff3388b389866bb3cc8cd7070e9
- name: rs/event-plugin
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/event-plugin
  newTag: news-personalize-5d2609f82e3d2ff3388b389866bb3cc8cd7070e9
- name: rs/filter
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/filter
  newTag: 25f170269e3288d5fbe6c20d02557c5c000e1c96
- name: rs/filter-plugin
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/filter-plugin
  newTag: news-25f170269e3288d5fbe6c20d02557c5c000e1c96
- name: rs/loader
  newName: public.ecr.aws/t8u1z3c8/rs/loader
  newTag: latest
- name: rs/personalize
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/personalize
  newTag: 70ce93340bd476f190c565af7f04dbd6b43d17f8
- name: rs/portrait
  newName: public.ecr.aws/t8u1z3c8/rs/portrait
  newTag: latest
- name: rs/portrait-plugin
  newName: public.ecr.aws/t8u1z3c8/rs/portrait-plugin
  newTag: latest
- name: rs/rank
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/rank
  newTag: a95248599c277f4e62d51e87c6b1ecb8136e58d3
- name: rs/rank-plugin
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/rank-plugin
  newTag: news-a95248599c277f4e62d51e87c6b1ecb8136e58d3
- name: rs/recall
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/recall
  newTag: 2daa2ec0f2f16006a36c051896547a849e9a032b
- name: rs/recall-plugin
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/recall-plugin
  newTag: news-2daa2ec0f2f16006a36c051896547a849e9a032b
- name: rs/retrieve
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/retrieve
  newTag: 81c51506740240aaaaa2178cf7922929d804c35c
- name: rs/retrieve-plugin
  newName: 466154167985.dkr.ecr.ap-northeast-1.amazonaws.com/rs/retrieve-plugin
  newTag: news-personalize-81c51506740240aaaaa2178cf7922929d804c35c
- name: rs/ui
  newName: public.ecr.aws/t8u1z3c8/rs/ui
  newTag: latest



vars:
- fieldref:
    fieldPath: data.redis_host
  name: REDIS_HOST
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.redis_port
  name: REDIS_PORT
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.messge_broker_redis_host
  name: MESSGE_BROKER_REDIS_HOST
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.messge_broker_redis_port
  name: MESSGE_BROKER_REDIS_PORT
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.aws_region
  name: AWS_REGION
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.s3_bucket
  name: S3_BUCKET
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.s3_prefix
  name: S3_PREFIX
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.click_record_bucket
  name: CLICK_RECORD_BUCKET
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.click_record_file_path
  name: CLICK_RECORD_FILE_PATH
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.user_record_file_path
  name: USER_RECORD_FILE_PATH
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
- fieldref:
    fieldPath: data.local_data_folder
  name: LOCAL_DATA_FOLDER
  objref:
    apiVersion: v1
    kind: ConfigMap
    name: rs-news-dev-config
